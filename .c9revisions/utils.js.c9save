{"ts":1366084787624,"silentsave":true,"restoring":false,"patch":[[{"diffs":[[1,"// Import the Express web framework.\nvar express = require('express');\n\n// Import a library for accessing couchdb.\nvar cradle = require('cradle');\n\nfunction initializeWebApp() {\n  // Create and configure a new web application.\n  var app = express.createServer();\n  // Configure the Express web framework.\n  app.configure(function () {\n    app.set('views', __dirname + '/views');\n    app.set('view engine', 'ejs');\n    app.set('view options', { layout: false });\n    app.use(express.bodyParser());\n    app.use(app.router);\n    app.use(express.static(__dirname + '/public'));\n    app.use(express.errorHandler({ dumpExceptions: true, showStack: true })); \n  });\n  return app;\n}\nexports.initializeWebApp = initializeWebApp;\n\nfunction connectToDatabase(name) {\n  if (! name) { throw Error('Must specify database name'); }\n  var host = 'https://sils-webinfo.iriscouch.com/';\n  var port = 443;\n  return new (\n    function(db) {\n      db.exists(function (err, exists) {\n        if (err) { console.log('error', err); } \n        else if (! exists) {\n          db.create(function(err) {\n            if (err) { console.error(err); }\n            else { console.log('Created new database.'); }\n          });\n        }      \n      });\n      this.save = function() { \n        var args = arguments;\n        db.save.apply(db, args); \n      };\n      this.filterDocs = function (accept, callback) {\n        var that = this;\n        db.all({ include_docs: true }, function(err, rows) {\n          if (err) { return that.handleErr(err, callback); }\n          var results = [];\n          for (var i = 0; i < rows.length; i++) {\n            var doc = rows[i].doc;\n            if (accept(doc)) {\n              results.push(doc); \n            }\n          }\n          return callback(null, results);\n        });\n      };\n      this.getSome = function(item_type, query, callback) {\n        if (! item_type) { callback('No item type was specified'); }\n        this.filterDocs(function (doc) {\n          if (doc.type !== item_type ) { return false; }\n          for (var prop in query) {\n            if (prop in doc) {\n              if (typeof(query[prop]) == 'string') {\n                if (doc[prop].toLowerCase().indexOf(query[prop].toLowerCase()) < 0) {\n                  return false;\n                } \n              } else {\n                if (doc.doc[prop] !== query[prop]) {\n                  return false;\n                }\n              }\n            }\n          }\n          return true;\n        }, callback);\n      };\n      this.getAll = function(item_type, callback) {\n        if (! item_type) { callback('No item type was specified'); }\n        this.filterDocs(function (doc) { \n          return doc.type === item_type; \n        }, callback);\n      };\n      this.getOne = function(item_type, item_id, callback) {\n        var that = this;\n        db.get(item_id, function(err, doc) {\n          if (err) { return that.handleErr(err, callback); }\n          if (doc.type !== item_type) {\n            return callback({ \n                error: 'not found', \n                reason: 'item ' + item_id + ' is not of type ' + item_type });\n          }\n          return callback(null, doc);\n        });\n      };\n      this.handleErr = function(err, callback) {\n        console.trace();\n        console.error(err);\n        callback(err); \n      };\n    })(new(cradle.Connection)(host, port).database(name));\n}\nexports.connectToDatabase = connectToDatabase;\n\n// Authenticate a user using the HTTP Basic Authentication protocol.\nfunction authenticateUser(db, req, res, next) {\n\n  var parts, auth, scheme, credentials; \n  var view, options;\n  \n  // handle auth stuff\n  auth = req.headers[\"authorization\"];\n  if (!auth){\n    return authRequired(res, 'Microblog');\n  }  \n  \n  parts = auth.split(' ');\n  scheme = parts[0];\n  credentials = new Buffer(parts[1], 'base64').toString().split(':');\n  \n  if ('Basic' != scheme) {\n    return res.send('Unsupported authorization scheme', 400);\n  } \n  req.credentials = credentials;\n\n  // ok, let's look this user up\n  view = 'microblog/users_by_id';\n  \n  options = {};\n  options.descending='true';\n  options.key=req.credentials[0];\n  \n  db.view(view, options, function(err, doc) {\n    try {\n      if(doc[0].value.password===req.credentials[1]) {\n        next(req,res);\n      }\n      else {\n        throw new Error('Invalid User');\n      } \n    }\n    catch (ex) {\n      return authRequired(res, 'Microblog');\n    }\n  });\n}\nexports.authenticateUser = authenticateUser;\n\n// 'Negotiate' content type; i.e. send them what they requested.\nfunction negotiateContentType(req) {\n  switch(req.headers['accept']) {\n    case 'text/xml':\n      return 'text/xml';\n    case 'application/xml':\n      return 'application/xml';\n    case 'application/xhtml+xml':\n      return 'application/xhtml+xml';\n    default:\n      return 'text/html';\n  }\n}\nexports.negotiateContentType = negotiateContentType;\n\n// Get today's date as a y-m-d string.\nfunction today() {\n\n  var y, m, d, dt;\n  \n  dt = new Date();\n\n  y = String(dt.getFullYear());\n  \n  m = String(dt.getMonth()+1);\n  if(m.length===1) {\n    m = '0'+m;\n  }\n\n  d = String(dt.getDate());\n  if(d.length===1) {\n    d = '0'+d.toString();\n  }\n\n  return y+'-'+m+'-'+d;\n}\nexports.today = today;\n\n// Get the current date and time as a string.\nfunction now() {\n  var y, m, d, h, i, s, dt;\n  \n  dt = new Date();\n  \n  y = String(dt.getFullYear());\n  \n  m = String(dt.getMonth()+1);\n  if(m.length===1) {\n    m = '0'+m;\n  }\n\n  d = String(dt.getDate());\n  if(d.length===1) {\n    d = '0'+d.toString();\n  }\n  \n  h = String(dt.getHours()+1);\n  if(h.length===1) {\n    h = '0'+h;\n  }\n  \n  i = String(dt.getMinutes()+1);\n  if(i.length===1) {\n    i = '0'+i;\n  }\n  \n  s = String(dt.getSeconds()+1);\n  if(s.length===1) {\n    s = '0'+s;\n  }\n  return y+'-'+m+'-'+d+' '+h+':'+i+':'+s;\n}\nexports.now = now;\n\n// Return standard 'auth required' response.\nfunction authRequired(res,realm) {\n  var realm = (realm || 'Authentication Required');\n  res.send('Unauthorized', \n    { 'WWW-Authenticate': 'Basic realm=\"' + realm + '\"' }, 401);\n}\n\n\n"]],"start1":0,"start2":0,"length1":0,"length2":6046}]],"length":6046}
{"contributors":[],"silentsave":false,"ts":1366086146688,"patch":[[{"diffs":[[0,"01);\n}\n\n"],[1,"$(\"div#btn\").click(function() {\n    var sort_by_name = function(a, b) {\n        return a.innerHTML.toLowerCase().localeCompare(b.innerHTML.toLowerCase());\n    }\n    \n    var list = $(\"#table1 > li\").get();\n    list.sort(sort_by_name);\n    for (var i = 0; i < list.length; i++) {\n        list[i].parentNode.appendChild(list[i]);\n    }\n});"],[0,"\n"]],"start1":6037,"start2":6037,"length1":9,"length2":346}]],"length":6383,"saved":false}
{"ts":1366086938123,"patch":[[{"diffs":[[0,"\n}\n\n"],[-1,"$(\"div#btn\").click(function() {\n    var sort_by_name = function(a, b) {\n        return a.innerHTML.toLowerCase().localeCompare(b.innerHTML.toLowerCase());\n    }\n    \n    var list = $(\"#table1 > li\").get();\n    list.sort(sort_by_name);\n    for (var i = 0; i < list.length; i++) {\n        list[i].parentNode.appendChild(list[i]);\n    }\n});"],[0,"\n"]],"start1":6041,"start2":6041,"length1":342,"length2":5}]],"length":6046,"saved":false}
{"contributors":[],"silentsave":false,"ts":1366674993028,"patch":[[{"diffs":[[0,"amework."],[1,"\r"],[0,"\nvar exp"]],"start1":28,"start2":28,"length1":16,"length2":17},{"diffs":[[0,"press');"],[-1,"\n"],[1,"\r\n\r"],[0,"\n// Impo"]],"start1":63,"start2":63,"length1":17,"length2":19},{"diffs":[[0,"couchdb."],[1,"\r"],[0,"\nvar cra"]],"start1":109,"start2":109,"length1":16,"length2":17},{"diffs":[[0,"radle');"],[-1,"\n"],[1,"\r\n\r"],[0,"\nfunctio"]],"start1":142,"start2":142,"length1":17,"length2":19},{"diffs":[[0,"bApp() {"],[1,"\r"],[0,"\n  // Cr"]],"start1":175,"start2":175,"length1":16,"length2":17},{"diffs":[[0,"ication."],[1,"\r"],[0,"\n  var a"]],"start1":225,"start2":225,"length1":16,"length2":17},{"diffs":[[0,"erver();"],[1,"\r"],[0,"\n  // Co"]],"start1":262,"start2":262,"length1":16,"length2":17},{"diffs":[[0,"amework."],[1,"\r"],[0,"\n  app.c"]],"start1":305,"start2":305,"length1":16,"length2":17},{"diffs":[[0,"ion () {"],[1,"\r"],[0,"\n    app"]],"start1":336,"start2":336,"length1":16,"length2":17},{"diffs":[[0,"+ '/views');"],[1,"\r"],[0,"\n    app.set"]],"start1":377,"start2":377,"length1":24,"length2":25},{"diffs":[[0," 'ejs');"],[1,"\r"],[0,"\n    app"]],"start1":417,"start2":417,"length1":16,"length2":17},{"diffs":[[0,"t: false });"],[1,"\r"],[0,"\n    app.use"]],"start1":462,"start2":462,"length1":24,"length2":25},{"diffs":[[0,"rser());"],[1,"\r\n    app.use(express.methodOverride());\r"],[0,"\n    app"]],"start1":502,"start2":502,"length1":16,"length2":57},{"diffs":[[0,"router);"],[1,"\r"],[0,"\n    app"]],"start1":568,"start2":568,"length1":16,"length2":17},{"diffs":[[0,"blic'));"],[1,"\r"],[0,"\n    app"]],"start1":621,"start2":621,"length1":16,"length2":17},{"diffs":[[0,"ue })); "],[1,"\r"],[0,"\n  });"],[1,"\r"],[0,"\n  retur"]],"start1":701,"start2":701,"length1":22,"length2":24},{"diffs":[[0,"urn app;"],[1,"\r"],[0,"\n}"],[1,"\r"],[0,"\nexports"]],"start1":723,"start2":723,"length1":18,"length2":20},{"diffs":[[0,"eWebApp;"],[-1,"\n"],[1,"\r\n\r"],[0,"\nfunctio"]],"start1":772,"start2":772,"length1":17,"length2":19},{"diffs":[[0,"(name) {"],[1,"\r"],[0,"\n  if (!"]],"start1":810,"start2":810,"length1":16,"length2":17},{"diffs":[[0,"ame'); }"],[1,"\r"],[0,"\n  var h"]],"start1":872,"start2":872,"length1":16,"length2":17},{"diffs":[[0,"h.com/';"],[1,"\r"],[0,"\n  var p"]],"start1":925,"start2":925,"length1":16,"length2":17},{"diffs":[[0,"t = 443;"],[1,"\r"],[0,"\n  retur"]],"start1":944,"start2":944,"length1":16,"length2":17},{"diffs":[[0,"rn new ("],[1,"\r"],[0,"\n    fun"]],"start1":960,"start2":960,"length1":16,"length2":17},{"diffs":[[0,"on(db) {"],[1,"\r"],[0,"\n      d"]],"start1":980,"start2":980,"length1":16,"length2":17},{"diffs":[[0," (err, exists) {"],[1,"\r"],[0,"\n        if (err"]],"start1":1014,"start2":1014,"length1":32,"length2":33},{"diffs":[[0,"err); } "],[1,"\r"],[0,"\n       "]],"start1":1072,"start2":1072,"length1":16,"length2":17},{"diffs":[[0,"(! exists) {"],[1,"\r"],[0,"\n          d"]],"start1":1098,"start2":1098,"length1":24,"length2":25},{"diffs":[[0,"ate("],[-1,"function(err) {\n            if (err) { console.error(err); }\n "],[1,");\r\n"],[0,"    "]],"start1":1128,"start2":1128,"length1":70,"length2":12},{"diffs":[[0,"        "],[-1,"  else {"],[0," console"]],"start1":1137,"start2":1137,"length1":24,"length2":16},{"diffs":[[0,"base.');"],[-1," }\n  "],[1,"\r\n"],[0,"        "]],"start1":1175,"start2":1175,"length1":21,"length2":18},{"diffs":[[0,"   }"],[-1,");\n  "],[0,"      "],[-1,"}      "],[1,"\r"],[0,"\n   "]],"start1":1190,"start2":1190,"length1":26,"length2":15},{"diffs":[[0," \r\n      });"],[1,"\r"],[0,"\n      this."]],"start1":1199,"start2":1199,"length1":24,"length2":25},{"diffs":[[0,"unction() { "],[1,"\r"],[0,"\n        var"]],"start1":1232,"start2":1232,"length1":24,"length2":25},{"diffs":[[0,"guments;"],[1,"\r"],[0,"\n       "]],"start1":1267,"start2":1267,"length1":16,"length2":17},{"diffs":[[0," args); "],[1,"\r"],[0,"\n      }"]],"start1":1302,"start2":1302,"length1":16,"length2":17},{"diffs":[[0,"rgs); \r\n      };"],[1,"\r"],[0,"\n      this.filt"]],"start1":1304,"start2":1304,"length1":32,"length2":33},{"diffs":[[0,"ept, callback) {"],[1,"\r"],[0,"\n        var tha"]],"start1":1359,"start2":1359,"length1":32,"length2":33},{"diffs":[[0,"var that = this;"],[1,"\r"],[0,"\n        db.all("]],"start1":1385,"start2":1385,"length1":32,"length2":33},{"diffs":[[0," rows) {"],[1,"\r"],[0,"\n       "]],"start1":1455,"start2":1455,"length1":16,"length2":17},{"diffs":[[0,"rr, callback); }"],[1,"\r"],[0,"\n          var r"]],"start1":1509,"start2":1509,"length1":32,"length2":33},{"diffs":[[0,"ts = [];"],[1,"\r"],[0,"\n       "]],"start1":1546,"start2":1546,"length1":16,"length2":17},{"diffs":[[0,"; i++) {"],[1,"\r"],[0,"\n       "]],"start1":1597,"start2":1597,"length1":16,"length2":17},{"diffs":[[0,"[i].doc;"],[1,"\r"],[0,"\n       "]],"start1":1633,"start2":1633,"length1":16,"length2":17},{"diffs":[[0,"(doc)) {"],[1,"\r"],[0,"\n       "]],"start1":1665,"start2":1665,"length1":16,"length2":17},{"diffs":[[0,"h(doc); "],[1,"\r"],[0,"\n       "]],"start1":1700,"start2":1700,"length1":16,"length2":17},{"diffs":[[0," \r\n            }"],[1,"\r"],[0,"\n          }\n   "]],"start1":1707,"start2":1707,"length1":32,"length2":33},{"diffs":[[0,"  }\r\n          }"],[1,"\r"],[0,"\n          retur"]],"start1":1720,"start2":1720,"length1":32,"length2":33},{"diffs":[[0,"esults);"],[1,"\r"],[0,"\n       "]],"start1":1771,"start2":1771,"length1":16,"length2":17},{"diffs":[[0,"s);\r\n        });"],[1,"\r"],[0,"\n      };\n      "]],"start1":1776,"start2":1776,"length1":32,"length2":33},{"diffs":[[0,"   });\r\n      };"],[1,"\r"],[0,"\n      this.getS"]],"start1":1786,"start2":1786,"length1":32,"length2":33},{"diffs":[[0,"ery, callback) {"],[1,"\r"],[0,"\n        if (! i"]],"start1":1847,"start2":1847,"length1":32,"length2":33},{"diffs":[[0,"s specified'); }"],[1,"\r"],[0,"\n        this.fi"]],"start1":1917,"start2":1917,"length1":32,"length2":33},{"diffs":[[0,"tion (doc) {"],[1,"\r"],[0,"\n          i"]],"start1":1963,"start2":1963,"length1":24,"length2":25},{"diffs":[[0,"false; }"],[1,"\r"],[0,"\n       "]],"start1":2025,"start2":2025,"length1":16,"length2":17},{"diffs":[[0,"query) {"],[1,"\r"],[0,"\n       "]],"start1":2062,"start2":2062,"length1":16,"length2":17},{"diffs":[[0,"op in doc) {"],[1,"\r"],[0,"\n           "]],"start1":2090,"start2":2090,"length1":24,"length2":25},{"diffs":[[0,"ring') {"],[1,"\r"],[0,"\n       "]],"start1":2148,"start2":2148,"length1":16,"length2":17},{"diffs":[[0,") < 0) {"],[1,"\r"],[0,"\n       "]],"start1":2235,"start2":2235,"length1":16,"length2":17},{"diffs":[[0,"   return false;"],[1,"\r"],[0,"\n               "]],"start1":2260,"start2":2260,"length1":32,"length2":33},{"diffs":[[0,"          } "],[1,"\r"],[0,"\n           "]],"start1":2284,"start2":2284,"length1":24,"length2":25},{"diffs":[[0,"    } else {"],[1,"\r"],[0,"\n           "]],"start1":2308,"start2":2308,"length1":24,"length2":25},{"diffs":[[0,"ery[prop]) {"],[1,"\r"],[0,"\n           "]],"start1":2362,"start2":2362,"length1":24,"length2":25},{"diffs":[[0,"n false;"],[1,"\r"],[0,"\n       "]],"start1":2399,"start2":2399,"length1":16,"length2":17},{"diffs":[[0,"               }"],[1,"\r"],[0,"\n              }"]],"start1":2410,"start2":2410,"length1":32,"length2":33},{"diffs":[[0,"\n              }"],[1,"\r"],[0,"\n            }\n "]],"start1":2427,"start2":2427,"length1":32,"length2":33},{"diffs":[[0,"}\r\n            }"],[1,"\r"],[0,"\n          }\n   "]],"start1":2442,"start2":2442,"length1":32,"length2":33},{"diffs":[[0,"  }\r\n          }"],[1,"\r"],[0,"\n          retur"]],"start1":2455,"start2":2455,"length1":32,"length2":33},{"diffs":[[0,"rn true;"],[1,"\r"],[0,"\n       "]],"start1":2487,"start2":2487,"length1":16,"length2":17},{"diffs":[[0,"   }, callback);"],[1,"\r"],[0,"\n      };\n      "]],"start1":2502,"start2":2502,"length1":32,"length2":33},{"diffs":[[0,"back);\r\n      };"],[1,"\r"],[0,"\n      this.getA"]],"start1":2512,"start2":2512,"length1":32,"length2":33},{"diffs":[[0,"ype, callback) {"],[1,"\r"],[0,"\n        if (! i"]],"start1":2565,"start2":2565,"length1":32,"length2":33},{"diffs":[[0,"ecified'); }"],[1,"\r"],[0,"\n        thi"]],"start1":2639,"start2":2639,"length1":24,"length2":25},{"diffs":[[0,"(doc) { "],[1,"\r"],[0,"\n       "]],"start1":2686,"start2":2686,"length1":16,"length2":17},{"diffs":[[0,"m_type; "],[1,"\r"],[0,"\n       "]],"start1":2729,"start2":2729,"length1":16,"length2":17},{"diffs":[[0,"llback);"],[1,"\r"],[0,"\n      }"]],"start1":2752,"start2":2752,"length1":16,"length2":17},{"diffs":[[0,"back);\r\n      };"],[1,"\r"],[0,"\n      this.getO"]],"start1":2754,"start2":2754,"length1":32,"length2":33},{"diffs":[[0,"_id, callback) {"],[1,"\r"],[0,"\n        var tha"]],"start1":2816,"start2":2816,"length1":32,"length2":33},{"diffs":[[0," = this;"],[1,"\r"],[0,"\n       "]],"start1":2850,"start2":2850,"length1":16,"length2":17},{"diffs":[[0,"(err, doc) {"],[1,"\r"],[0,"\n          i"]],"start1":2892,"start2":2892,"length1":24,"length2":25},{"diffs":[[0,"back); }"],[1,"\r"],[0,"\n       "]],"start1":2958,"start2":2958,"length1":16,"length2":17},{"diffs":[[0,"item_type) {"],[1,"\r"],[0,"\n           "]],"start1":2995,"start2":2995,"length1":24,"length2":25},{"diffs":[[0,"lback({ "],[1,"\r"],[0,"\n       "]],"start1":3031,"start2":3031,"length1":16,"length2":17},{"diffs":[[0,"not found', "],[1,"\r"],[0,"\n           "]],"start1":3065,"start2":3065,"length1":24,"length2":25},{"diffs":[[0,"tem_type });"],[1,"\r"],[0,"\n          }"]],"start1":3145,"start2":3145,"length1":24,"length2":25},{"diffs":[[0,"\n          }"],[1,"\r"],[0,"\n          r"]],"start1":3158,"start2":3158,"length1":24,"length2":25},{"diffs":[[0,"l, doc);"],[1,"\r"],[0,"\n       "]],"start1":3201,"start2":3201,"length1":16,"length2":17},{"diffs":[[0,"     });"],[1,"\r"],[0,"\n      }"]],"start1":3214,"start2":3214,"length1":16,"length2":17},{"diffs":[[0,");\r\n      };"],[1,"\r"],[0,"\n      this."]],"start1":3220,"start2":3220,"length1":24,"length2":25},{"diffs":[[0,"lback) {"],[1,"\r"],[0,"\n       "]],"start1":3274,"start2":3274,"length1":16,"length2":17},{"diffs":[[0,"trace();"],[1,"\r"],[0,"\n       "]],"start1":3300,"start2":3300,"length1":16,"length2":17},{"diffs":[[0,"or(err);"],[1,"\r"],[0,"\n       "]],"start1":3329,"start2":3329,"length1":16,"length2":17},{"diffs":[[0,"k(err); "],[1,"\r"],[0,"\n      }"]],"start1":3354,"start2":3354,"length1":16,"length2":17},{"diffs":[[0,"      };"],[1,"\r"],[0,"\n    })("]],"start1":3364,"start2":3364,"length1":16,"length2":17},{"diffs":[[0,"(name));"],[1,"\r"],[0,"\n}"],[1,"\r"],[0,"\nexports"]],"start1":3424,"start2":3424,"length1":18,"length2":20},{"diffs":[[0,"atabase;"],[-1,"\n"],[1,"\r\n\r"],[0,"\n// Auth"]],"start1":3475,"start2":3475,"length1":17,"length2":19},{"diffs":[[0,"rotocol."],[1,"\r"],[0,"\nfunctio"]],"start1":3547,"start2":3547,"length1":16,"length2":17},{"diffs":[[0," next) {"],[-1,"\n"],[1,"\r\n\r"],[0,"\n  var p"]],"start1":3596,"start2":3596,"length1":17,"length2":19},{"diffs":[[0,"ntials; "],[1,"\r"],[0,"\n  var v"]],"start1":3640,"start2":3640,"length1":16,"length2":17},{"diffs":[[0,"options;"],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  // ha"]],"start1":3662,"start2":3662,"length1":19,"length2":21},{"diffs":[[0,"th stuff"],[1,"\r"],[0,"\n  auth "]],"start1":3690,"start2":3690,"length1":16,"length2":17},{"diffs":[[0,"ation\"];"],[1,"\r"],[0,"\n  if (!"]],"start1":3730,"start2":3730,"length1":16,"length2":17},{"diffs":[[0,"(!auth){"],[1,"\r"],[0,"\n    ret"]],"start1":3745,"start2":3745,"length1":16,"length2":17},{"diffs":[[0,"g');"],[1,"\r"],[0,"\n  }  "],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  p"]],"start1":3793,"start2":3793,"length1":17,"length2":20},{"diffs":[[0,"it(' ');"],[1,"\r"],[0,"\n  schem"]],"start1":3828,"start2":3828,"length1":16,"length2":17},{"diffs":[[0,"arts[0];"],[1,"\r"],[0,"\n  crede"]],"start1":3850,"start2":3850,"length1":16,"length2":17},{"diffs":[[0,"it(':');"],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  if ('"]],"start1":3921,"start2":3921,"length1":19,"length2":21},{"diffs":[[0,"cheme) {"],[1,"\r"],[0,"\n    ret"]],"start1":3953,"start2":3953,"length1":16,"length2":17},{"diffs":[[0,"', 400);"],[1,"\r"],[0,"\n  } "],[1,"\r"],[0,"\n  req.c"]],"start1":4016,"start2":4016,"length1":21,"length2":23},{"diffs":[[0,"entials;"],[-1,"\n"],[1,"\r\n\r"],[0,"\n  // ok"]],"start1":4056,"start2":4056,"length1":17,"length2":19},{"diffs":[[0," user up"],[1,"\r"],[0,"\n  view "]],"start1":4092,"start2":4092,"length1":16,"length2":17},{"diffs":[[0,"_by_id';"],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  optio"]],"start1":4127,"start2":4127,"length1":19,"length2":21},{"diffs":[[0,"ns = {};"],[1,"\r"],[0,"\n  optio"]],"start1":4148,"start2":4148,"length1":16,"length2":17},{"diffs":[[0,"='true';"],[1,"\r"],[0,"\n  optio"]],"start1":4178,"start2":4178,"length1":16,"length2":17},{"diffs":[[0,"ials[0];"],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  db.vi"]],"start1":4213,"start2":4213,"length1":19,"length2":21},{"diffs":[[0,", doc) {"],[1,"\r"],[0,"\n    try"]],"start1":4264,"start2":4264,"length1":16,"length2":17},{"diffs":[[0,"   try {"],[1,"\r"],[0,"\n      i"]],"start1":4275,"start2":4275,"length1":16,"length2":17},{"diffs":[[0,"ntials[1]) {"],[1,"\r"],[0,"\n        nex"]],"start1":4327,"start2":4327,"length1":24,"length2":25},{"diffs":[[0,"eq,res);"],[1,"\r"],[0,"\n      }"],[1,"\r"],[0,"\n      e"]],"start1":4355,"start2":4355,"length1":24,"length2":26},{"diffs":[[0,"  else {"],[1,"\r"],[0,"\n       "]],"start1":4378,"start2":4378,"length1":16,"length2":17},{"diffs":[[0," User');"],[1,"\r"],[0,"\n      }"]],"start1":4420,"start2":4420,"length1":16,"length2":17},{"diffs":[[0,"      } "],[1,"\r"],[0,"\n    }"],[1,"\r"],[0,"\n    cat"]],"start1":4430,"start2":4430,"length1":22,"length2":24},{"diffs":[[0,"h (ex) {"],[1,"\r"],[0,"\n      r"]],"start1":4455,"start2":4455,"length1":16,"length2":17},{"diffs":[[0,"g');"],[1,"\r"],[0,"\n    }"],[1,"\r"],[0,"\n  });"],[1,"\r"],[0,"\n}"],[1,"\r"],[0,"\nexp"]],"start1":4505,"start2":4505,"length1":22,"length2":26},{"diffs":[[0,"ateUser;"],[-1,"\n"],[1,"\r\n\r"],[0,"\n// 'Neg"]],"start1":4564,"start2":4564,"length1":17,"length2":19},{"diffs":[[0,"quested."],[1,"\r"],[0,"\nfunctio"]],"start1":4632,"start2":4632,"length1":16,"length2":17},{"diffs":[[0,"e(req) {"],[1,"\r"],[0,"\n  switc"]],"start1":4670,"start2":4670,"length1":16,"length2":17},{"diffs":[[0,"ept']) {"],[1,"\r"],[0,"\n    cas"]],"start1":4705,"start2":4705,"length1":16,"length2":17},{"diffs":[[0," 'text/xml':"],[1,"\r"],[0,"\n      retur"]],"start1":4723,"start2":4723,"length1":24,"length2":25},{"diffs":[[0," 'text/xml';"],[1,"\r"],[0,"\n    case 'a"]],"start1":4749,"start2":4749,"length1":24,"length2":25},{"diffs":[[0,"cation/xml':"],[1,"\r"],[0,"\n      retur"]],"start1":4778,"start2":4778,"length1":24,"length2":25},{"diffs":[[0,"cation/xml';"],[1,"\r"],[0,"\n    case 'a"]],"start1":4811,"start2":4811,"length1":24,"length2":25},{"diffs":[[0,"ml+xml':"],[1,"\r"],[0,"\n      r"]],"start1":4850,"start2":4850,"length1":16,"length2":17},{"diffs":[[0,"ml+xml';"],[1,"\r"],[0,"\n    def"]],"start1":4889,"start2":4889,"length1":16,"length2":17},{"diffs":[[0,"default:"],[1,"\r"],[0,"\n      r"]],"start1":4903,"start2":4903,"length1":16,"length2":17},{"diffs":[[0,"ml';"],[1,"\r"],[0,"\n  }"],[1,"\r"],[0,"\n}"],[1,"\r"],[0,"\nexp"]],"start1":4934,"start2":4934,"length1":14,"length2":17},{"diffs":[[0,"entType;"],[-1,"\n"],[1,"\r\n\r"],[0,"\n// Get "]],"start1":4992,"start2":4992,"length1":17,"length2":19},{"diffs":[[0," a y-m-d string."],[1,"\r"],[0,"\nfunction today("]],"start1":5026,"start2":5026,"length1":32,"length2":33},{"diffs":[[0,"oday() {"],[-1,"\n"],[1,"\r\n\r"],[0,"\n  var y"]],"start1":5054,"start2":5054,"length1":17,"length2":19},{"diffs":[[0,"y, m, d, dt;"],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  dt = new "]],"start1":5072,"start2":5072,"length1":27,"length2":29},{"diffs":[[0," Date();"],[-1,"\n"],[1,"\r\n\r"],[0,"\n  y = S"]],"start1":5100,"start2":5100,"length1":17,"length2":19},{"diffs":[[0,".getFullYear());"],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  m = String(dt"]],"start1":5127,"start2":5127,"length1":35,"length2":37},{"diffs":[[0,"t.getMonth()+1);"],[1,"\r"],[0,"\n  if(m.length=="]],"start1":5163,"start2":5163,"length1":32,"length2":33},{"diffs":[[0,"(m.length===1) {"],[1,"\r"],[0,"\n    m = '0'+m;\n"]],"start1":5185,"start2":5185,"length1":32,"length2":33},{"diffs":[[0,"\r\n    m = '0'+m;"],[1,"\r"],[0,"\n  }"],[-1,"\n"],[1,"\r\n\r"],[0,"\n  d = String(dt"]],"start1":5201,"start2":5201,"length1":37,"length2":40},{"diffs":[[0,"g(dt.getDate());"],[1,"\r"],[0,"\n  if(d.length=="]],"start1":5237,"start2":5237,"length1":32,"length2":33},{"diffs":[[0,"(d.length===1) {"],[1,"\r"],[0,"\n    d = '0'+d.t"]],"start1":5259,"start2":5259,"length1":32,"length2":33},{"diffs":[[0,"tring();"],[1,"\r"],[0,"\n  }"],[-1,"\n"],[1,"\r\n\r"],[0,"\n  retur"]],"start1":5294,"start2":5294,"length1":21,"length2":24},{"diffs":[[0,"m+'-'+d;"],[1,"\r"],[0,"\n}"],[1,"\r"],[0,"\nexports"]],"start1":5326,"start2":5326,"length1":18,"length2":20},{"diffs":[[0,"= today;"],[-1,"\n"],[1,"\r\n\r"],[0,"\n// Get "]],"start1":5353,"start2":5353,"length1":17,"length2":19},{"diffs":[[0," string."],[1,"\r"],[0,"\nfunctio"]],"start1":5402,"start2":5402,"length1":16,"length2":17},{"diffs":[[0," now() {"],[1,"\r"],[0,"\n  var y"]],"start1":5420,"start2":5420,"length1":16,"length2":17},{"diffs":[[0,", s, dt;"],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  dt = "]],"start1":5449,"start2":5449,"length1":19,"length2":21},{"diffs":[[0," Date();"],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  y = S"]],"start1":5473,"start2":5473,"length1":19,"length2":21},{"diffs":[[0,"Year());"],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  m = S"]],"start1":5510,"start2":5510,"length1":19,"length2":21},{"diffs":[[0,"tMonth()+1);"],[1,"\r"],[0,"\n  if(m.leng"]],"start1":5542,"start2":5542,"length1":24,"length2":25},{"diffs":[[0,"ength===1) {"],[1,"\r"],[0,"\n    m = '0'"]],"start1":5564,"start2":5564,"length1":24,"length2":25},{"diffs":[[0,"= '0'+m;"],[1,"\r"],[0,"\n  }"],[-1,"\n"],[1,"\r\n\r"],[0,"\n  d = S"]],"start1":5584,"start2":5584,"length1":21,"length2":24},{"diffs":[[0,"Date());"],[1,"\r"],[0,"\n  if(d."]],"start1":5620,"start2":5620,"length1":16,"length2":17},{"diffs":[[0,"ength===1) {"],[1,"\r"],[0,"\n    d = '0'"]],"start1":5638,"start2":5638,"length1":24,"length2":25},{"diffs":[[0,"tring();"],[1,"\r"],[0,"\n  }"],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  h = S"]],"start1":5669,"start2":5669,"length1":23,"length2":26},{"diffs":[[0,"tHours()+1);"],[1,"\r"],[0,"\n  if(h.leng"]],"start1":5706,"start2":5706,"length1":24,"length2":25},{"diffs":[[0,"ength===1) {"],[1,"\r"],[0,"\n    h = '0'"]],"start1":5728,"start2":5728,"length1":24,"length2":25},{"diffs":[[0,"= '0'+h;"],[1,"\r"],[0,"\n  }"],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  i = S"]],"start1":5748,"start2":5748,"length1":23,"length2":26},{"diffs":[[0,"inutes()+1);"],[1,"\r"],[0,"\n  if(i.leng"]],"start1":5787,"start2":5787,"length1":24,"length2":25},{"diffs":[[0,"ength===1) {"],[1,"\r"],[0,"\n    i = '0'"]],"start1":5809,"start2":5809,"length1":24,"length2":25},{"diffs":[[0,"= '0'+i;"],[1,"\r"],[0,"\n  }"],[1,"\r"],[0,"\n  "],[1,"\r"],[0,"\n  s = S"]],"start1":5829,"start2":5829,"length1":23,"length2":26},{"diffs":[[0,"ds()+1);"],[1,"\r"],[0,"\n  if(s."]],"start1":5872,"start2":5872,"length1":16,"length2":17},{"diffs":[[0,"h===1) {"],[1,"\r"],[0,"\n    s ="]],"start1":5894,"start2":5894,"length1":16,"length2":17},{"diffs":[[0,"= '0'+s;"],[1,"\r"],[0,"\n  }"],[1,"\r"],[0,"\n  retur"]],"start1":5910,"start2":5910,"length1":20,"length2":22},{"diffs":[[0,"i+':'+s;"],[1,"\r"],[0,"\n}"],[1,"\r"],[0,"\nexports"]],"start1":5958,"start2":5958,"length1":18,"length2":20},{"diffs":[[0,"w = now;"],[-1,"\n"],[1,"\r\n\r"],[0,"\n// Retu"]],"start1":5981,"start2":5981,"length1":17,"length2":19},{"diffs":[[0,"esponse."],[1,"\r"],[0,"\nfunctio"]],"start1":6029,"start2":6029,"length1":16,"length2":17},{"diffs":[[0,"realm) {"],[1,"\r"],[0,"\n  var r"]],"start1":6065,"start2":6065,"length1":16,"length2":17},{"diffs":[[0,"uired');"],[1,"\r"],[0,"\n  res.s"]],"start1":6118,"start2":6118,"length1":16,"length2":17},{"diffs":[[0,"rized', "],[1,"\r"],[0,"\n    { '"]],"start1":6147,"start2":6147,"length1":16,"length2":17},{"diffs":[[0,"01);"],[1,"\r"],[0,"\n}"],[-1,"\n\n"],[1,"\r\n\r\n\r"],[0,"\n"]],"start1":6217,"start2":6217,"length1":9,"length2":13}]],"length":6230,"saved":false}
{"contributors":[],"silentsave":false,"ts":1367788499502,"patch":[[{"diffs":[[0,"s); \r\n      };\r\n"],[1,"            this.remove = function() { \r\n        var args = arguments;\r\n        db.remove.apply(db, args); \r\n      };\r\n"],[0,"      this.filte"]],"start1":1306,"start2":1306,"length1":32,"length2":151}]],"length":6349,"saved":false}
{"ts":1367788501871,"patch":[[{"diffs":[[0,"    };\r\n"],[-1,"        "],[0,"    this"]],"start1":1314,"start2":1314,"length1":24,"length2":16}]],"length":6341,"saved":false}
{"contributors":[],"silentsave":false,"ts":1367853999389,"patch":[[{"diffs":[[0," });\r\n      };\r\n"],[1,"      this.match = function(query, draft) {\r\n+        if (Array.isArray(draft)) {\r\n+          if (draft.indexOf(query) < 0) {\r\n+            return false;\r\n+          }\r\n+        } else {\r\n+          if (typeof(query) == 'string') {\r\n+            if (draft.toLowerCase().indexOf(query.toLowerCase()) < 0) {\r\n+              return false;\r\n+            } \r\n+          } else {\r\n+            if (draft !== query) {\r\n+              return false;\r\n+            }\r\n+          }\r\n+        }\r\n+        return true;\r\n+      }\r\n"],[0,"      this.getSo"]],"start1":1899,"start2":1899,"length1":32,"length2":549}]],"length":6858,"saved":false}
{"ts":1367854240200,"patch":[[{"diffs":[[0,", draft) {\r\n"],[-1,"+"],[0,"        if ("]],"start1":1948,"start2":1948,"length1":25,"length2":24},{"diffs":[[0,"(draft)) {\r\n"],[-1,"+"],[0,"          if"]],"start1":1985,"start2":1985,"length1":25,"length2":24},{"diffs":[[0,"(query) < 0) {\r\n"],[-1,"+"],[0,"            retu"]],"start1":2024,"start2":2024,"length1":33,"length2":32},{"diffs":[[0," return false;\r\n"],[-1,"+"],[0,"          }\r\n+  "]],"start1":2051,"start2":2051,"length1":33,"length2":32},{"diffs":[[0,"     }\r\n"],[-1,"+"],[0,"       "],[-1," "],[0,"} else {"]],"start1":2072,"start2":2072,"length1":25,"length2":23},{"diffs":[[0,"      } else {\r\n"],[-1,"+"],[0,"          if (ty"]],"start1":2081,"start2":2081,"length1":33,"length2":32},{"diffs":[[0,"string') {\r\n"],[-1,"+"],[0,"            "]],"start1":2129,"start2":2129,"length1":25,"length2":24},{"diffs":[[0,"()) < 0) {\r\n"],[-1,"+"],[0,"            "]],"start1":2202,"start2":2202,"length1":25,"length2":24},{"diffs":[[0," return false;\r\n"],[-1,"+"],[0,"            } \r\n"]],"start1":2227,"start2":2227,"length1":33,"length2":32},{"diffs":[[0,"    } \r\n"],[-1,"+"],[0,"        "]],"start1":2251,"start2":2251,"length1":17,"length2":16},{"diffs":[[0,"  } else {\r\n"],[-1,"+"],[0,"            "]],"start1":2267,"start2":2267,"length1":25,"length2":24},{"diffs":[[0,"ery) {\r\n"],[-1,"+"],[0,"        "]],"start1":2307,"start2":2307,"length1":17,"length2":16},{"diffs":[[0,"{\r\n             "],[-1," "],[0,"return false;\r\n+"]],"start1":2312,"start2":2312,"length1":33,"length2":32},{"diffs":[[0,"urn false;\r\n"],[-1,"+"],[0,"            "]],"start1":2331,"start2":2331,"length1":25,"length2":24},{"diffs":[[0,"\n            }\r\n"],[-1,"+"],[0,"          }\r\n+  "]],"start1":2342,"start2":2342,"length1":33,"length2":32},{"diffs":[[0,"}\r\n          }\r\n"],[-1,"+"],[0,"        }\r\n+    "]],"start1":2355,"start2":2355,"length1":33,"length2":32},{"diffs":[[0,"     }\r\n"],[-1,"+"],[0,"        "]],"start1":2374,"start2":2374,"length1":17,"length2":16},{"diffs":[[0," true;\r\n"],[-1,"+"],[0,"      }\r"]],"start1":2396,"start2":2396,"length1":17,"length2":16},{"diffs":[[0,";\r\n      }\r\n"],[1," "],[0,"      this.g"]],"start1":2401,"start2":2401,"length1":24,"length2":25},{"diffs":[[0,"    if ("],[1,"! "],[0,"prop in "]],"start1":2690,"start2":2690,"length1":16,"length2":18},{"diffs":[[0,"            "],[-1,"if (typeof"],[1,"return false;\r\n            } else {\r\n              if (Array.isArray"],[0,"(query[prop]"]],"start1":2718,"start2":2718,"length1":34,"length2":92},{"diffs":[[0,"y[prop])"],[-1," == 'string'"],[0,") {\r\n   "]],"start1":2803,"start2":2803,"length1":28,"length2":16},{"diffs":[[0,"    "],[-1,"if (doc[prop].toLowerCase().indexOf(query[prop].toLowerCase()) < 0"],[1,"query[prop].forEach(function (q) {\r\n                  if (this.match(q, doc[prop])"],[0,") {\r\n"],[1,"  "],[0,"    "]],"start1":2828,"start2":2828,"length1":79,"length2":97},{"diffs":[[0,"         return "],[-1,"fals"],[1,"tru"],[0,"e;\r\n            "]],"start1":2930,"start2":2930,"length1":36,"length2":35},{"diffs":[[0,"    "],[-1,"} \r\n              } else {\r\n                if (doc.doc[prop] !== query[prop]) {\r\n           "],[1,"  }\r\n                });\r\n                return false;\r\n              } else {\r\n                return this.match(query[prop], doc[prop]);\r\n              }\r\n            }\r\n          }\r\n"],[0,"       "],[1,"   "],[0,"return "],[-1,"fals"],[1,"tru"],[0,"e;\r\n"]],"start1":2965,"start2":2965,"length1":119,"length2":214},{"diffs":[[0,"    "],[-1,"  "],[1,"}, callback);\r\n"],[0,"      }"],[1,";"],[0,"\r\n      "],[-1,"    "],[1,"this.getAll = function(item_type, callback) {\r\n"],[0,"    "],[-1,"}\r\n"],[0,"    "],[-1,"        }\r\n          }\r\n          return tru"],[1,"if (! item_type) { callback('No item type was specified'); }\r\n        this.filterDocs(function (doc) { \r\n          return doc.type === item_typ"],[0,"e;"],[1," "],[0,"\r\n  "]],"start1":3183,"start2":3183,"length1":86,"length2":240}]],"length":7154,"saved":false}
{"ts":1367854358486,"patch":[[{"diffs":[[0,"\r\n      };\r\n"],[-1,"     "],[0," this.match "]],"start1":1903,"start2":1903,"length1":29,"length2":24},{"diffs":[[0,"(query, "],[-1,"draft"],[1,"candidate"],[0,") {\r\n   "]],"start1":1937,"start2":1937,"length1":21,"length2":25},{"diffs":[[0,"isArray("],[-1,"draft"],[1,"candidate"],[0,")) {\r\n  "]],"start1":1977,"start2":1977,"length1":21,"length2":25},{"diffs":[[0,"    if ("],[-1,"draft"],[1,"candidate"],[0,".indexOf"]],"start1":2006,"start2":2006,"length1":21,"length2":25},{"diffs":[[0,"  }\r\n       "],[-1,""],[0,""],[1," "],[0,"} else {\r\n  "]],"start1":2082,"start2":2082,"length1":24,"length2":25},{"diffs":[[0,"    if ("],[-1,"draft"],[1,"candidate"],[0,".toLower"]],"start1":2157,"start2":2157,"length1":21,"length2":25},{"diffs":[[0,"if ("],[-1,"draft"],[1,"candidate"],[0," !=="]],"start1":2303,"start2":2303,"length1":13,"length2":17},{"diffs":[[0,"e !== query) {\r\n"],[1," "],[0,"             ret"]],"start1":2315,"start2":2315,"length1":32,"length2":33},{"diffs":[[0,";\r\n      }\r\n"],[-1," "],[0,"      this.g"]],"start1":2418,"start2":2418,"length1":25,"length2":24},{"diffs":[[0,"};\r\n"],[-1,"      this.getAll = function(item_type, callback) {\r\n        if (! item_type) { callback('No item type was specified'); }\r\n        this.filterDocs(function (doc) { \r\n          return doc.type === item_type; \r\n        }, callback);\r\n      };\r\n"],[0,"    "]],"start1":3466,"start2":3466,"length1":250,"length2":8}]],"length":6928,"saved":false}
{"ts":1367854400850,"patch":[[{"diffs":[[0,"};\r\n"],[-1," this.match = function(query, candidate) {\r\n        if (Array.isArray(candidate)) {\r\n          if (candidate.indexOf(query) < 0) {\r\n            return false;\r\n          }\r\n        } else {\r\n          if (typeof(query) == 'string') {\r\n            if (candidate.toLowerCase().indexOf(query.toLowerCase()) < 0) {\r\n              return false;\r\n            } \r\n          } else {\r\n            if (candidate !== query) {\r\n              return false;\r\n            }\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n"],[0,"    "]],"start1":1911,"start2":1911,"length1":523,"length2":8},{"diffs":[[0,"    if ("],[-1,"! "],[0,"prop in "]],"start1":2191,"start2":2191,"length1":18,"length2":16},{"diffs":[[0,"    "],[-1,"return false;\r\n            } else {\r\n              if (Array.isArray"],[1,"if (typeof"],[0,"(que"]],"start1":2225,"start2":2225,"length1":76,"length2":18},{"diffs":[[0,"query[prop])"],[1," == 'string'"],[0,") {\r\n       "]],"start1":2240,"start2":2240,"length1":24,"length2":36},{"diffs":[[0,"    "],[-1,"query[prop].forEach(function (q) {\r\n                  if (this.match(q, doc[prop])"],[1,"if (doc[prop].toLowerCase().indexOf(query[prop].toLowerCase()) < 0"],[0,") {\r\n"],[-1,"  "],[0,"    "]],"start1":2281,"start2":2281,"length1":97,"length2":79},{"diffs":[[0,"         return "],[-1,"tru"],[1,"fals"],[0,"e;\r\n            "]],"start1":2365,"start2":2365,"length1":35,"length2":36},{"diffs":[[0,"                "],[-1,"  "],[0,"}"],[1," "],[0,"\r\n              "]],"start1":2389,"start2":2389,"length1":35,"length2":34},{"diffs":[[0,"            "],[-1,"  });"],[1,"} else {"],[0,"\r\n          "]],"start1":2411,"start2":2411,"length1":29,"length2":32},{"diffs":[[0,"            "],[-1,"return false;"],[1,"if (doc.doc[prop] !== query[prop]) {"],[0,"\r\n          "]],"start1":2437,"start2":2437,"length1":37,"length2":60},{"diffs":[[0,"            "],[-1,"} else {"],[1,"    return false;"],[0,"\r\n          "]],"start1":2489,"start2":2489,"length1":32,"length2":41},{"diffs":[[0,"    "],[-1,"return this.match(query[prop], doc[prop]);"],[1,"}"],[0,"\r\n  "]],"start1":2532,"start2":2532,"length1":50,"length2":9}]],"length":6341,"saved":false}
{"contributors":[],"silentsave":false,"ts":1367858926653,"patch":[[{"diffs":[[0,"   this."],[-1,""],[1,"match = function(query, candidate) {\r\n        if (Array.isArray(candidate)) {\r\n          if (candidate.indexOf(query) < 0) {\r\n            return false;\r\n          }\r\n        } else {\r\n          if (typeof(query) == 'string') {\r\n            if (candidate.toLowerCase().indexOf(query.toLowerCase()) < 0) {\r\n              return false;\r\n            } \r\n          } else {\r\n            if (candidate !== query) {\r\n              return false;\r\n            }\r\n          }\r\n        }\r\n        return true;\r\n      }\r\n      this."],[0,"getSome "]],"start1":1918,"start2":1918,"length1":16,"length2":536},{"diffs":[[0,"specified'); }\r\n"],[1,"        var that = this;\r\n"],[0,"        this.fil"]],"start1":2550,"start2":2550,"length1":32,"length2":58},{"diffs":[[0,"    if ("],[1,"! "],[0,"prop in "]],"start1":2737,"start2":2737,"length1":16,"length2":18},{"diffs":[[0,"            "],[-1,"if (typeof"],[1,"return false;\r\n            } else {\r\n              if (Array.isArray"],[0,"(query[prop]"]],"start1":2765,"start2":2765,"length1":34,"length2":92},{"diffs":[[0,"y[prop])"],[-1," == 'string'"],[0,") {\r\n   "]],"start1":2850,"start2":2850,"length1":28,"length2":16},{"diffs":[[0,"    "],[-1,"if (doc[prop].toLowerCase().indexOf(query[prop].toLowerCase()) < 0"],[1,"query[prop].forEach(function (q) {\r\n                  if (that.match(q, doc[prop])"],[0,") {\r\n"],[1,"  "],[0,"    "]],"start1":2875,"start2":2875,"length1":79,"length2":97},{"diffs":[[0,"         return "],[-1,"fals"],[1,"tru"],[0,"e;\r\n            "]],"start1":2977,"start2":2977,"length1":36,"length2":35},{"diffs":[[0,"                "],[-1,"}"],[0," "],[1," }"],[0,"\r\n              "]],"start1":3000,"start2":3000,"length1":34,"length2":35},{"diffs":[[0,"            "],[-1,"} else {"],[1,"  });"],[0,"\r\n          "]],"start1":3023,"start2":3023,"length1":32,"length2":29},{"diffs":[[0,"    "],[-1,"if (doc.doc[prop] !== query[prop]) {"],[1,"return false;"],[0,"\r\n  "]],"start1":3054,"start2":3054,"length1":44,"length2":21},{"diffs":[[0,"        "],[-1,"    return false;"],[1,"} else {"],[0,"\r\n      "]],"start1":3079,"start2":3079,"length1":33,"length2":24},{"diffs":[[0,"                "],[-1,"}"],[1,"return that.match(query[prop], doc[prop]);"],[0,"\r\n              "]],"start1":3097,"start2":3097,"length1":33,"length2":74}]],"length":6959,"saved":false}
{"ts":1367862044601,"patch":[[{"diffs":[[0,";\r\n  }  \r\n  "],[1," "],[0,"\r\n  parts = "]],"start1":4525,"start2":4525,"length1":24,"length2":25}]],"length":6960,"saved":false}
{"ts":1367862119336,"patch":[[{"diffs":[[0," }  \r\n  "],[-1," "],[0,"\r\n  part"]],"start1":4529,"start2":4529,"length1":17,"length2":16}]],"length":6959,"saved":false}
